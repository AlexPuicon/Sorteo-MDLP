<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorteo Tributario - Distrito en Acción</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="municipal-header">
                <div class="municipal-logo">
                    <i class="fas fa-landmark"></i>
                </div>
                <div class="title-container">
                    <h1>SORTEO TRIBUTARIO</h1>
                    <p class="subtitle">Municipalidad Distrital de Las Piedras</p>
                    <div class="campaign-name">CAMPAÑA "DISTRITO EN ACCIÓN"</div>
                </div>
            </div>
            <p class="header-description">
                Sistema de sorteo para la campaña de recaudación tributaria. Ingrese los premios y realice sorteos individuales.
            </p>
        </header>
        
        <div class="content">
            <div class="upload-section">
                <h2 class="section-title"><i class="fas fa-file-upload"></i> Cargar Participantes</h2>
                
                <div class="alert alert-error" id="errorAlert">
                    <strong>Error:</strong> <span id="errorMessage"></span>
                </div>
                
                <div class="alert alert-success" id="successAlert">
                    <strong>Éxito:</strong> <span id="successMessage"></span>
                </div>
                
                <div class="alert alert-info" id="infoAlert">
                    <strong>Información:</strong> <span id="infoMessage"></span>
                </div>
                
                <div class="file-upload">
                    <i class="fas fa-file-excel"></i>
                    <p>Suba el archivo de contribuyentes para el sorteo</p>
                    <p><strong>Formato requerido:</strong> columnas "codpersona" y "datospersona"</p>
                    <input type="file" id="excelFile" class="file-input" accept=".xlsx, .xls, .csv">
                    <label for="excelFile" class="file-label">
                        <i class="fas fa-upload"></i> Seleccionar Archivo Excel
                    </label>
                </div>
                
                <div class="participants-info">
                    <h4><i class="fas fa-users"></i> Participantes Cargados</h4>
                    <p id="participantCount">No se ha cargado ningún archivo aún.</p>
                    
                    <div class="participants-list" id="participantsList">
                        <!-- Los participantes se mostrarán aquí -->
                    </div>
                </div>
            </div>
            
            <div class="sorteo-section">
                <h2 class="section-title"><i class="fas fa-gift"></i> Configurar Premios</h2>
                
                <div class="premio-config">
                    <div class="premio-input-group">
                        <input type="text" id="premioInput" class="premio-input" placeholder="Ej: Moto 0km, Televisor 55', Refrigeradora, etc.">
                        <button id="agregarPremioBtn" class="btn-agregar">
                            <i class="fas fa-plus"></i> Agregar
                        </button>
                    </div>
                    <p class="premio-hint"><i class="fas fa-info-circle"></i> Ingrese cada premio que desea sortear individualmente</p>
                    
                    <div class="premios-list" id="premiosList">
                        <!-- Los premios se mostrarán aquí -->
                    </div>
                </div>
                
                <h2 class="section-title"><i class="fas fa-random"></i> Realizar Sorteo</h2>
                
                <div class="sorteo-info">
                    <div class="intentos-info">
                        <span>Intento actual: <strong id="intentoActual">1</strong> de 3</span>
                        <div class="intentos-marcadores">
                            <span class="intento-marcador activo" data-intento="1">1</span>
                            <span class="intento-marcador" data-intento="2">2</span>
                            <span class="intento-marcador" data-intento="3">3</span>
                        </div>
                        <span id="estadoIntento">Primer intento (Al Agua)</span>
                    </div>
                    
                    <div class="premio-actual-info">
                        <h4>Premio a sortear:</h4>
                        <div id="premioActualNombre">Ningún premio seleccionado</div>
                    </div>
                </div>
                
                <!-- Contenedor para la animación del sorteo -->
                <div class="animacion-sorteo-container" id="animacionContainer">
                    <div class="animacion-header">
                        <h3><i class="fas fa-spinner"></i> Seleccionando ganador...</h3>
                        <div class="animacion-progreso">
                            <div class="progreso-bar" id="progresoBar"></div>
                        </div>
                    </div>
                    <div class="animacion-display" id="animacionDisplay">
                        <!-- Los participantes en movimiento se mostrarán aquí -->
                        <div class="participante-animado destacado" id="participanteDestacado">
                            <div class="participante-codigo">CP000</div>
                            <div class="participante-nombre">Nombre del participante</div>
                        </div>
                    </div>
                    <div class="animacion-controles">
                        <button id="iniciarAnimacionBtn" class="btn btn-animar">
                            <i class="fas fa-play"></i> Iniciar Animación de Sorteo
                        </button>
                    </div>
                </div>
                
                <div class="sorteo-actions">
                    <button id="sortearBtn" class="btn btn-sortear">
                        <i class="fas fa-dice"></i> Realizar Intento de Sorteo
                    </button>
                    <button id="nuevoPremioBtn" class="btn btn-nuevo-premio">
                        <i class="fas fa-gift"></i> Preparar Nuevo Premio
                    </button>
                    <button id="resetBtn" class="btn btn-reset">
                        <i class="fas fa-redo"></i> Reiniciar Todo
                    </button>
                </div>
                
                <div class="ganadores-container" id="ganadoresContainer">
                    <!-- Los ganadores se mostrarán aquí -->
                    <div class="placeholder-ganadores">
                        <i class="fas fa-trophy"></i>
                        <h3>Esperando resultados del sorteo</h3>
                        <p>Los ganadores aparecerán aquí después de cada sorteo</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="municipal-footer">
            <p><strong>Municipalidad Distrital de Las Piedras</strong> - Campaña Tributaria "Distrito en Acción"</p>
            <p class="municipal-contact">
                <i class="fas fa-phone"></i> (01) 123-4567 | 
                <i class="fas fa-envelope"></i> tributacion@munilaspeiedras.gob.pe | 
                <i class="fas fa-map-marker-alt"></i> Plaza Principal S/N, Las Piedras
            </p>
            <p class="footer-note">Sistema de sorteo desarrollado para la recaudación tributaria 2023</p>
        </footer>
    </div>

    <!-- Modal para mostrar resultados de sorteo -->
    <div id="resultadoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitulo">Resultado del Sorteo</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Contenido del modal se insertará aquí -->
            </div>
        </div>
    </div>

    <!-- Canvas para efectos de fuegos artificiales -->
    <canvas id="fireworksCanvas"></canvas>

    <!-- Incluir SheetJS para leer archivos Excel -->
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>